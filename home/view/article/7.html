<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<title>如何在控制器开启事务处理?---XbPhp框架--争取智能化的框架,执行效率高,简单上手</title>
<meta name="keywords" content="XbPhp,XbPhp框架,PHP框架,PHP智能框架,跨平台框架" />
<meta name="description" content="XbPhp框架的宗旨是实现智能化，兼容性强,简单上手,不一样的文件缓存机制" />
<link rel="stylesheet" type="text/css" href="<{$herf}>css/style.css" />
<script type="text/javascript" src="<{$herf}>js/jquery-1.4.3.min.js"></script>
<style>
.head h1 a { 
	width: 260px; 
	height: 95px; 
	background-image: url(<{$herf}>images/logo.jpg); 
	text-indent: -9999px; 
	overflow: hidden;
}
.body .content ul p {
	font-size: 18px;
}
</style>
<{include file="header.html"}>
<div class="body">
	<div class="content">
		<ul>
			<p>我们创建一个home/controller目录下载创建一个IndexController.php,创建好,代码如下:</p>
			<pre class="brush:php; toolbar: true; auto-links: false;" style="font-size:12px">
			//必须要继承AppController
			&lt;?php  class IndexController extends AppController {
				&nbsp;&nbsp;//要加载的模型,此模型文件为数据表的名字,如 数据表的名字bc_wz,加载模型的写法如下
				&nbsp;&nbsp;public $uses = array('BcWz');
				&nbsp;&nbsp;//要自动初始化函数,必须在构造函数里面写上parent::__construct()先初始化父类
				&nbsp;&nbsp;public function _initialize() {
					&nbsp;&nbsp;&nbsp;&nbsp;parent::_initialize();
				&nbsp;&nbsp;}
				&nbsp;&nbsp; public function test() {
						&nbsp;&nbsp;//设置缓存文件的目录,可以不设置,在配置文件会有默认设置
						&nbsp;&nbsp;Cache::path('linshi'); 
						&nbsp;&nbsp;/*
						&nbsp;&nbsp;*第一个参数是缓存文件的名字,第二个参数是回调函数必须有返回值,第三个是傳入参数,第三个是缓存文件的生存时间
						&nbsp;&nbsp;*/
						&nbsp;&nbsp;Cache::wirte('aa',function($model){
						&nbsp;&nbsp;return $model;
						&nbsp;&nbsp;},$this,100);
						&nbsp;&nbsp;读取缓存文件 
						&nbsp;&nbsp;dump(Cache::read('aa')); 
						&nbsp;&nbsp;//删除缓存文件
						&nbsp;&nbsp;Cache::del('aa');
				&nbsp;&nbsp;}
			} 
			?&gt;
			</pre>
			<p>这样我们在访问url:http://localhost/xbphp/Index/test/<br>
				这样每隔一段时间,就会自动更新缓存文件,无需进行判断<br>
				传入的参数可以以任何类型进行传入,这样接受的参数就可以以数组或对象接收,无需定义多个变量<br>
				生存时间,暂时没确定是秒还是毫秒..所以只能说这个数值越大,缓存时间越长,如果为0或为空则永久缓存<br>
				这是XbPhp特色的写法
			</p>
		</ul>
	</div>
</div>
<script type="text/javascript" src="<{$herf}>js/shbrush.js"></script>
	<link type="text/css" rel="stylesheet" href="<{$herf}>css/shcore.css"/>
<link type="text/css" rel="stylesheet" href="<{$herf}>css/shthemedefault.css"/>
<script type="text/javascript">
	SyntaxHighlighter.all();
</script>
<{include file="footer.html"}>
</body>
</html>